<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Filter specific cell type signature genes against other subsets. — filter_subset_sig • mastR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Filter specific cell type signature genes against other subsets. — filter_subset_sig"><meta property="og:description" content="Specify the signature of the subset matched 'target_group' against other subsets,
either &quot;union&quot;, &quot;intersect&quot; or &quot;RRA&quot; can be specified when input is a list
of datasets to integrate the signatures into one."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mastR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/mastR_Demo.html">mastR: Markers Automated Screening Tool in R</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/DavisLaboratory/mastR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Filter specific cell type signature genes against other subsets.</h1>
    <small class="dont-index">Source: <a href="https://github.com/DavisLaboratory/mastR/blob/HEAD/R/AllGenerics.R" class="external-link"><code>R/AllGenerics.R</code></a>, <a href="https://github.com/DavisLaboratory/mastR/blob/HEAD/R/filter_subset_sig-methods.R" class="external-link"><code>R/filter_subset_sig-methods.R</code></a></small>
    <div class="hidden name"><code>filter_subset_sig.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Specify the signature of the subset matched 'target_group' against other subsets,
either "union", "intersect" or "RRA" can be specified when input is a list
of datasets to integrate the signatures into one.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">filter_subset_sig</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">group_col</span>,</span>
<span>  <span class="va">target_group</span>,</span>
<span>  markers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dir <span class="op">=</span> <span class="st">"UP"</span>,</span>
<span>  gene_id <span class="op">=</span> <span class="st">"SYMBOL"</span>,</span>
<span>  feature_selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"rankproduct"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  comb <span class="op">=</span> <span class="va">union</span>,</span>
<span>  filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  s_thres <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for list</span></span>
<span><span class="fu">filter_subset_sig</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">group_col</span>,</span>
<span>  <span class="va">target_group</span>,</span>
<span>  markers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dir <span class="op">=</span> <span class="st">"UP"</span>,</span>
<span>  gene_id <span class="op">=</span> <span class="st">"SYMBOL"</span>,</span>
<span>  feature_selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"rankproduct"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  comb <span class="op">=</span> <span class="va">union</span>,</span>
<span>  filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  s_thres <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  slot <span class="op">=</span> <span class="st">"counts"</span>,</span>
<span>  batch <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for DGEList</span></span>
<span><span class="fu">filter_subset_sig</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">group_col</span>,</span>
<span>  <span class="va">target_group</span>,</span>
<span>  markers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dir <span class="op">=</span> <span class="st">"UP"</span>,</span>
<span>  gene_id <span class="op">=</span> <span class="st">"SYMBOL"</span>,</span>
<span>  feature_selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"rankproduct"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  comb <span class="op">=</span> <span class="va">union</span>,</span>
<span>  filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  s_thres <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for ANY</span></span>
<span><span class="fu">filter_subset_sig</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">group_col</span>,</span>
<span>  <span class="va">target_group</span>,</span>
<span>  markers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dir <span class="op">=</span> <span class="st">"UP"</span>,</span>
<span>  gene_id <span class="op">=</span> <span class="st">"SYMBOL"</span>,</span>
<span>  feature_selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"rankproduct"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  comb <span class="op">=</span> <span class="va">union</span>,</span>
<span>  filter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  s_thres <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>An expression data or a list of expression data objects</p></dd>


<dt>group_col</dt>
<dd><p>vector or character, specify the group factor or column name of
coldata for DE comparisons</p></dd>


<dt>target_group</dt>
<dd><p>pattern, specify the group of interest, e.g. NK</p></dd>


<dt>markers</dt>
<dd><p>vector, a vector of gene names, listed the gene symbols to be
kept anyway after filtration. Default 'NULL' means no special
genes need to be kept.</p></dd>


<dt>normalize</dt>
<dd><p>logical, if the expr in data is raw counts needs to be normalized</p></dd>


<dt>dir</dt>
<dd><p>character, could be 'UP' or 'DOWN' to use only up- or
down-expressed genes</p></dd>


<dt>gene_id</dt>
<dd><p>character, specify the gene ID target_group of rownames of expression data
when markers is not NULL, could be one of 'ENSEMBL', 'SYMBOL',
'ENTREZ'..., default 'SYMBOL'</p></dd>


<dt>feature_selection</dt>
<dd><p>one of "auto" (default), "rankproduct" or "none",
choose if to use rank product or not to select DEGs
from multiple comparisons of DE analysis, 'auto'
uses 'rankproduct' but change to 'none' if final
genes &lt; 5 for both UP and DOWN</p></dd>


<dt>comb</dt>
<dd><p>'RRA' or Fun for combining sigs from multiple datasets, keep all
passing genes or only intersected genes, could be <code>union</code> or
<code>intersect</code> or <code>setdiff</code> or customized Fun, or could be 'RRA' to
use Robust Rank Aggregation method for integrating multi-lists
of sigs, default 'union'</p></dd>


<dt>filter</dt>
<dd><p>(list of) vector of 2 numbers, filter condition to remove low
expression genes, the 1st for min.counts (if normalize = TRUE)
or CPM/TPM (if normalize = FALSE), the 2nd for samples size 'large.n'</p></dd>


<dt>s_thres</dt>
<dd><p>num, threshold of score if comb = 'RRA'</p></dd>


<dt>...</dt>
<dd><p>other params for <code><a href="get_degs.html">get_degs()</a></code></p></dd>


<dt>slot</dt>
<dd><p>character, specify which slot to use only for DGEList, sce or
seurat object, optional, default 'counts'</p></dd>


<dt>batch</dt>
<dd><p>vector of character, column name(s) of coldata to be treated as
batch effect factor, default NULL</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>a vector of gene symbols</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"im_data_6"</span>, <span class="st">"nk_markers"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sigs</span> <span class="op">&lt;-</span> <span class="fu">filter_subset_sig</span><span class="op">(</span><span class="va">im_data_6</span>, <span class="st">"celltype:ch1"</span>, <span class="st">"NK"</span>,</span></span>
<span class="r-in"><span>  markers <span class="op">=</span> <span class="va">nk_markers</span><span class="op">$</span><span class="va">HGNC_Symbol</span>,</span></span>
<span class="r-in"><span>  gene_id <span class="op">=</span> <span class="st">"ENSEMBL"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'select()' returned 1:many mapping between keys and columns</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        NK-Neutrophils NK-Monocytes NK-B.cells NK-CD4 NK-CD8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Down             4011         3946       3145   2696   2154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NotSig           1489         2688       4420   4995   6192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Up               4935         3801       2870   2744   2089</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'select()' returned 1:many mapping between keys and columns</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jinjin Chen, Ahmed Mohamed.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

      </footer></div>

  


  

  </body></html>

