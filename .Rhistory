s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("SYMBOL", "ENSEMBL")
)
remove_bg_snr(
ccle_crc_5$counts,
Biobase::exprs(im_data_6),
b_group_col = ccle_crc_5$samples$cancer,
b_target_group = "CRC",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("SYMBOL", "ENSEMBL")
)
remove_bg_snr(
ccle_crc_5,
Biobase::exprs(im_data_6),
b_group_col = "cancer",
b_target_group = "CRC",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("SYMBOL", "ENSEMBL")
)
remove_bg_snr(
ccle_crc_5,
im_data_6,
b_group_col = "cancer",
b_target_group = "CRC",
s_group_col = "celltype:ch1",
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("SYMBOL", "ENSEMBL")
)
remove_bg_snr(
ccle_crc_5$counts,
Biobase::exprs(im_data_6),
b_group_col = ccle_crc_5$samples$cancer,
b_target_group = "CRC",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("SYMBOL", "ENSEMBL")
)
remove_bg_snr(
ccle_crc_5,
Biobase::exprs(im_data_6),
b_group_col = "cancer",
b_target_group = "CRC",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("SYMBOL", "ENSEMBL")
)
remove_bg_snr(
im_data_6,
Biobase::exprs(im_data_6),
b_group_col = "celltype.ch1",
b_target_group = "CD4",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = "ENSEMBL"
)
remove_bg_snr(
im_data_6,
Biobase::exprs(im_data_6),
b_group_col = "celltype:ch1",
b_target_group = "CD4",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = "ENSEMBL"
)
remove_bg_snr(
Biobase::exprs(im_data_6),
ccle_crc_5,
s_group_col = "cancer",
s_target_group = "CRC",
b_group_col = im_data_6$`celltype:ch1`,
b_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("ENSEMBL", "SYMBOL")
)
remove_bg_snr(
Biobase::exprs(im_data_6),
ccle_crc_5,
b_group_col = im_data_6$`celltype:ch1`,
b_target_group = "NK",
s_group_col = "cancer",
s_target_group = "CRC",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("ENSEMBL", "SYMBOL")
)
devtools::load_all()
Seurat::CreateSeuratObject(counts = ccle_crc_5$counts,
meta.data = ccle_crc_5$samples)
## test seurat
data_seurat <- Seurat::CreateSeuratObject(counts = ccle_crc_5$counts,
meta.data = ccle_crc_5$samples)
remove_bg_snr(
data_seurat,
Biobase::exprs(im_data_6),
b_group_col = "cancer",
b_target_group = "CRC",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("SYMBOL", "ENSEMBL")
)
devtools::load_all()
a_seurat,
remove_bg_snr(
data_seurat,
Biobase::exprs(im_data_6),
b_group_col = "cancer",
b_target_group = "CRC",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("SYMBOL", "ENSEMBL")
)
remove_bg_snr(
data_seurat,
Biobase::exprs(im_data_6),
b_group_col = "cancer",
b_target_group = "CRC",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("SYMBOL", "ENSEMBL")
)
remove_bg_snr(
data_seurat,
Biobase::exprs(im_data_6),
b_group_col = "cancer",
b_target_group = "CRC",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("SYMBOL", "ENSEMBL")
)
remove_bg_snr(
ccle_crc_5,
Biobase::exprs(im_data_6),
b_group_col = "cancer",
b_target_group = "CRC",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("SYMBOL", "ENSEMBL")
)
remove_bg_snr(
ccle_crc_5,
Biobase::exprs(im_data_6),
b_group_col = "cancer",
b_target_group = "CRC",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("SYMBOL", "ENSEMBL")
)
remove_bg_snr(
ccle_crc_5,
Biobase::exprs(im_data_6),
b_group_col = "cancer",
b_target_group = "CRC",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("SYMBOL", "ENSEMBL"), filter = c(1,2)
)
remove_bg_snr(
ccle_crc_5,
Biobase::exprs(im_data_6),
b_group_col = "cancer",
b_target_group = "CRC",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("SYMBOL", "ENSEMBL"), filter = c(1,2)
)
devtools::load_all()
remove_bg_snr(
# "CCLE",
Biobase::exprs(im_data_6),
b_group_col = "primary_disease",
b_target_group = "colorectal",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = "ENSEMBL",
ignore.case = TRUE
)
devtools::load_all()
remove_bg_snr(
# "CCLE",
Biobase::exprs(im_data_6),
b_group_col = "primary_disease",
b_target_group = "colorectal",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = "ENSEMBL",
ignore.case = TRUE
)
remove_bg_snr(
# "CCLE",
sig_data = Biobase::exprs(im_data_6),
b_group_col = "primary_disease",
b_target_group = "colorectal",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = "ENSEMBL",
ignore.case = TRUE
)
devtools::load_all()
remove_bg_snr(
# "CCLE",
sig_data = Biobase::exprs(im_data_6),
b_group_col = "primary_disease",
b_target_group = "colorectal",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = "ENSEMBL",
ignore.case = TRUE
)
remove_bg_snr(
# "CCLE",
sig_data = Biobase::exprs(im_data_6),
b_group_col = "primary_disease",
b_target_group = "colorectal",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = "ENSEMBL",
filter = c(1, 10),
ignore.case = TRUE
)
devtools::load_all()
remove_bg_snr(
# "CCLE",
sig_data = Biobase::exprs(im_data_6),
b_group_col = "primary_disease",
b_target_group = "colorectal",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = "ENSEMBL",
filter = c(1, 10),
ignore.case = TRUE
)
devtools::load_all()
remove_bg_snr(
# "CCLE",
sig_data = Biobase::exprs(im_data_6),
b_group_col = "primary_disease",
b_target_group = "colorectal",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = "ENSEMBL",
filter = c(1, 10),
ignore.case = TRUE
)
ccle_tpm <- depmap::depmap_TPM()
ccle_meta <- depmap::depmap_metadata()
tidyr::pivot_wider(ccle_tpm[1:100, c("rna_expression", "depmap_id")],
names_from = "depmap_id",
values_from = "rna_expression")
tidyr::pivot_wider(ccle_tpm[1:100, c("gene_name", "rna_expression", "depmap_id")],
names_from = "depmap_id",
values_from = "rna_expression")
devtools::load_all()
remove_bg_snr(
# "CCLE",
sig_data = Biobase::exprs(im_data_6),
b_group_col = "primary_disease",
b_target_group = "colorectal",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = "ENSEMBL",
filter = c(1, 10),
ignore.case = TRUE
)
devtools::load_all()
remove_bg_snr(
# "CCLE",
sig_data = Biobase::exprs(im_data_6),
b_group_col = "primary_disease",
b_target_group = "colorectal",
s_group_col = im_data_6$`celltype:ch1`,
s_target_group = "NK",
markers = NK_markers$HGNC_Symbol[40:50],
gene_id = c("SYMBOL", "ENSEMBL"),
filter = c(1, 10),
ignore.case = TRUE
)
devtools::document()
AnnotationDbi::mapIds(org.Hs.eg.db, rownames(im_data_6), "SYMBOL", "ENSEMBL")
AnnotationDbi::mapIds(org.Hs.eg.db, rownames(im_data_6), "SYMBOL", "ENSEMBL") |> na.omit()
AnnotationDbi::mapIds(org.Hs.eg.db, rownames(im_data_6), "SYMBOL", "ENSEMBL") |> na.omit() |> length()
AnnotationDbi::mapIds(org.Hs.eg.db, rownames(im_data_6), "SYMBOL", "ENSEMBL") |> na.omit() |> unique() |> length()
AnnotationDbi::mapIds(org.Hs.eg.db, rownames(im_data_6), "SYMBOL", "ENSEMBL") |> na.omit() |> table() |> sort()
AnnotationDbi::mapIds(org.Hs.eg.db, rownames(im_data_6), "SYMBOL", "ENSEMBL") |> na.omit() |> table() |> sort() |> tail()
AnnotationDbi::mapIds(org.Hs.eg.db, rownames(proc_data), "SYMBOL", "ENSEMBL") |> na.omit() |> table() |> sort() |> tail()
AnnotationDbi::mapIds(org.Hs.eg.db, rownames(proc_data), "SYMBOL", "ENSEMBL") |> na.omit() |> unique() |> length()
AnnotationDbi::mapIds(org.Hs.eg.db, rownames(proc_data), "SYMBOL", "ENSEMBL") |> na.omit() |> length()
setdiff(1:3,1:3)
setdiff(1:3,1:3) |> length()
(setdiff(1:3,1:3) |> length()) == 0
paste("Gene", m_out, "is not in sig_data! So remove it!")
paste("Gene", 1:3, "is not in sig_data! So remove it!")
paste("Gene", 1:3, "is not in sig_data! So remove it!") |> warnings()
paste("Gene", 1:3, "is not in sig_data! So remove it!\n") |> warnings()
paste("Gene", 1:3, "is not in sig_data! So remove it!\n") |> warnings()
paste("Gene", 1:3, "is not in sig_data! So remove it!\n")
paste("Gene", 1:3, "is not in sig_data! So remove it!\n") |> warnings()
paste("Gene", 1:3, "is not in sig_data! So remove it!\n") |> warning()
paste("Gene", 1:3, "is not in sig_data! So remove it!") |> warning()
warning(paste("Gene", m_out, "is not in sig_data! So remove it!\n"))
warning(paste("Gene", 1:3, "is not in sig_data! So remove it!\n"))
devtools::load_all()
remove_bg_snr(ccle_crc_5, Biobase::exprs(im_data_6),
"cancer", "CRC", ## for bg_data
"celltype:ch1", "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol[30:40],
gene_id = c("SYMBOL", "ENSEMBL"))
`remove_bg_snr(ccle_crc_5, Biobase::exprs(im_data_6),
"cancer", "CRC", ## for bg_data
im_data_6$`celltype:ch1`, "NK", ## for sig_data
remove_bg_snr(ccle_crc_5, Biobase::exprs(im_data_6),
"cancer", "CRC", ## for bg_data
im_data_6$`celltype:ch1`, "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol[30:40],
gene_id = c("SYMBOL", "ENSEMBL"))
remove_bg_snr(ccle_crc_5, Biobase::exprs(im_data_6),
"cancer", "CRC", ## for bg_data
im_data_6$`celltype:ch1`, "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol[30:40],
gene_id = c("SYMBOL", "ENSEMBL"))
remove_bg_snr(ccle_crc_5, Biobase::exprs(im_data_6),
"cancer", "CRC", ## for bg_data
im_data_6$`celltype:ch1`, "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol,
gene_id = c("SYMBOL", "ENSEMBL"))
devtools::document()
devtools::check()
BiocCheck::BiocCheck()
devtools::document()
BiocCheck::BiocCheck()
devtools::install()
devtools::load_all()
ccle_crc_5["RAB27B",]
density(ccle_crc_5$counts) |> plot()
quantile(ccle_crc_5$counts[ccle_crc_5$counts != 0], 0.25)
ccle_crc_5["RAB27B",]
ccle_crc_5$counts["RAB27B",]
ccle_crc_5$counts["RAB27B",] |> median()
ccle_crc_5$counts["RAB27B",] |> mean()
ccle_crc_5$counts["SH2D1B",] |> mean()
ccle_crc_5$counts["SH2D1B",] |> median()
ccle_crc_5$counts["SH2D1B",]
ccle_crc_5$counts["TXK",]
ccle_crc_5$counts["TXK",] |> median()
ccle_crc_5$counts["TXK",] |> mean()
ccle_crc_5$counts["CD244",] |> mean()
ccle_crc_5$counts["CD244",]
ccle_crc_5$counts["CD226",]
quantile(ccle_crc_5$counts[ccle_crc_5$counts != 0], 0.3)
remove_bg_snr(ccle_crc_5, proc_data,
"cancer", "CRC", ## for bg_data
"celltype.ch1", "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol,
gene_id = c("SYMBOL", "ENSEMBL"),
filter = c(1,2),
s_slot = "voomE")
remove_bg_snr(ccle_crc_5, proc_data,
"cancer", "crc", ## for bg_data
"celltype.ch1", "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol,
gene_id = c("SYMBOL", "ENSEMBL"),
filter = c(1,2),
s_slot = "voomE")
devtools::load_all()
remove_bg_snr(ccle_crc_5, proc_data,
"cancer", "crc", ## for bg_data
"celltype.ch1", "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol,
gene_id = c("SYMBOL", "ENSEMBL"),
filter = c(1,2),
s_slot = "voomE")
proc_data$samples$celltype.ch1
remove_bg_snr(ccle_crc_5, proc_data,
"cancer", "crc", ## for bg_data
"celltype.ch1", "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol,
gene_id = c("SYMBOL", "ENSEMBL"),
filter = c(1,2),
s_slot = "voomE")
remove_bg_snr(ccle_crc_5, proc_data,
"cancer", "crc", ## for bg_data
"celltype.ch1", "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol,
gene_id = c("SYMBOL", "ENSEMBL"),
filter = c(1,2),
s_slot = "voomE", ignore.case = T)
remove_bg_snr(ccle_crc_5, proc_data,
"cancer", "CRC", ## for bg_data
"celltype.ch1", "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol,
gene_id = c("SYMBOL", "ENSEMBL"),
filter = c(1,2),
s_slot = "voomE", ignore.case = T)
remove_bg_snr(ccle_crc_5, proc_data,
"cancer", "CRC", ## for bg_data
"celltype.ch1", "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol,
gene_id = c("SYMBOL", "ENSEMBL"),
filter = c(1,2),
s_slot = "voomE")
devtools::load_all()
remove_bg_snr(ccle_crc_5, proc_data,
"cancer", "crc", ## for bg_data
"celltype.ch1", "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol,
gene_id = c("SYMBOL", "ENSEMBL"),
filter = c(1,2),
s_slot = "voomE")
remove_bg_snr(ccle_crc_5, proc_data,
"cancer", "crc", ## for bg_data
"celltype.ch1", "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol,
gene_id = c("SYMBOL", "ENSEMBL"),
filter = c(1,2),
s_slot = "voomE", ignore.case = T)
remove_bg_snr("CCLE", proc_data,
"primary_disease", "crc", ## for bg_data
"celltype.ch1", "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol,
gene_id = c("SYMBOL", "ENSEMBL"),
filter = c(1,2),
s_slot = "voomE", ignore.case = T)
remove_bg_snr("CCLE", proc_data,
"primary_disease", "crc", ## for bg_data
"celltype.ch1", "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol,
gene_id = c("SYMBOL", "ENSEMBL"),
filter = c(1,10),
s_slot = "voomE", ignore.case = T)
remove_bg_snr("CCLE", proc_data,
"primary_disease", "colorectal", ## for bg_data
"celltype.ch1", "NK", ## for sig_data
markers = NK_markers$HGNC_Symbol,
gene_id = c("SYMBOL", "ENSEMBL"),
filter = c(1,10),
s_slot = "voomE", ignore.case = T)
devtools::document()
devtools::install()
sym(add.scope)
!!sym(add.scope)
data.frame(x = 1:10, y = 1:10) |> ggplot() + geom_point(aes(x = x, y = y))
data.frame(x = 1:10, y = 1:10) |> ggplot() + geom_point(aes(x = x, y = -log(y)))
data.frame(x = 1:10, y = 1:10) |> ggplot() + geom_point(aes(x = x, y = !!sym(-log(y))))
data.frame(x = 1:10, y = 1:10) |> ggplot() + geom_point(aes(x = x, y = !!sym("-log(y"))))
data.frame(x = 1:10, y = 1:10) |> ggplot() + geom_point(aes(x = x, y = !!sym("-log(y)")))
devtools::document()
devtools::load_all()
sig_gseaplot(sigs = list(A = NK_markers$HGNC_Symbol[1:15],
B = NK_markers$HGNC_Symbol[20:40],
C = NK_markers$HGNC_Symbol[60:75]),
data = im_data_6, group_col = "celltype:ch1",
target_group = "NK", gene_id = "ENSEMBL")
sig_gseaplot(sigs = list(A = NK_markers$HGNC_Symbol[1:15],
B = NK_markers$HGNC_Symbol[20:40],
C = NK_markers$HGNC_Symbol[60:75]),
data = im_data_6, group_col = "celltype:ch1",
target_group = "NK", gene_id = "ENSEMBL") +
sig_gseaplot(sigs = list(A = NK_markers$HGNC_Symbol[1:15],
B = NK_markers$HGNC_Symbol[20:40],
C = NK_markers$HGNC_Symbol[60:75]),
data = im_data_6, group_col = "celltype:ch1",
target_group = "NK", gene_id = "ENSEMBL", size = "-log10(p.adjust)",
col = "enrichmentScore",)
sig_gseaplot(sigs = list(A = NK_markers$HGNC_Symbol[1:15],
B = NK_markers$HGNC_Symbol[20:40],
C = NK_markers$HGNC_Symbol[60:75]),
data = im_data_6, group_col = "celltype:ch1",
target_group = "NK", gene_id = "ENSEMBL") +
sig_gseaplot(sigs = list(A = NK_markers$HGNC_Symbol[1:15],
B = NK_markers$HGNC_Symbol[20:40],
C = NK_markers$HGNC_Symbol[60:75]),
data = im_data_6, group_col = "celltype:ch1",
target_group = "NK", gene_id = "ENSEMBL", size = "-log10(p.adjust)",
col = "enrichmentScore") + plot_layout(guides = "keep")
sig_gseaplot(sigs = list(A = NK_markers$HGNC_Symbol[1:15],
B = NK_markers$HGNC_Symbol[20:40],
C = NK_markers$HGNC_Symbol[60:75]),
data = im_data_6, group_col = "celltype:ch1",
target_group = "NK", gene_id = "ENSEMBL") +
sig_gseaplot(sigs = list(A = NK_markers$HGNC_Symbol[1:15],
B = NK_markers$HGNC_Symbol[20:40],
C = NK_markers$HGNC_Symbol[60:75]),
data = im_data_6, group_col = "celltype:ch1",
target_group = "NK", gene_id = "ENSEMBL", size = "p.adjust",
col = "enrichmentScore") + plot_layout(guides = "keep")
devtools::document()
devtools::install()
devtools::document()
