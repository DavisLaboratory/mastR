library(devtools)
load_all()
GSEABase::GeneSet(NK_markers$HGNC_Symbol[1:20])
GSEABase::GeneSet(NK=NK_markers$HGNC_Symbol[1:20])
GSEABase::GeneSet(NK_markers$HGNC_Symbol[1:20], setIdentifier = "SYMBOL")
GSEABase::GeneSet(NK_markers$HGNC_Symbol[1:20], setName = "NK")
GSEABase::GeneSet(NK_markers$HGNC_Symbol[1:20], setName = "NK") |> class()
GSEABase::GeneSet(NK_markers$HGNC_Symbol[1:20], setName = "NK") |> typeof()
get_lm_sig("NK","NK")
get_lm_sig("NK")
get_lm_sig(lm22.pattern = "NK")
get_lm_sig("NK") |> GSEABase::GeneSet()
get_lm_sig("NK") |> GSEABase::GeneSet() -> gs1
gs1
get_lm_sig(lm22.pattern = "NK") |> GSEABase::GeneSet() -> gs2
gs2
gs1 | gs2
setNames(gs1)
GSEABase::setName(gs1)
GSEABase::setName(gs1) <- "LM7"
GSEABase::setName(gs2) <- "LM22"
gs1
gs1 | gs2
gs1 & gs2
GSEABase::geneIds(gs1 & gs2)
setdiff(gs1,gs2)
setdiff(gs1, gs2)
setdiff.Vector(gs1, gs2)
gs1 - gs2
GSEABase::GenenameIdentifier(gs1)
GSEABase::geneIdType(gs1)
GSEABase::geneIdType(gs1) <- GSEABase::SymbolIdentifier()
GSEABase::geneIdType(gs1)
msigdb::getMsigIdType(gs1)
GSEABase::GeneSetCollection(gs1)
GSEABase::GeneSetCollection(gs1) |> class()
GSEABase::GeneSetCollection(gs1) |> typeof()
GSEABase::GeneSetCollection(gs1) |> is.list()
GSEABase::GeneSetCollection(gs1, gs2)
GSEABase::GeneSetCollection(gs1, gs2) |> class()
GSEABase::GeneSetCollection(gs1, gs2) |> length()
GSEABase::GeneSetCollection(gs1, gs2)[[1]]
GSEABase::GeneSetCollection(gs1, gs2)[[2]]
GSEABase::GeneSetCollection(gs1, gs2)
GSEABase::GeneSetCollection(gs1, gs2) |> GSEABase::geneIds()
GSEABase::GeneSetCollection(gs1, gs2) |> msigdb::getMsigIdType()
GSEABase::GeneSetCollection(gs1) |> msigdb::getMsigIdType()
GSEABase::GeneSetCollection(gs2) |> msigdb::getMsigIdType()
GSEABase::geneIdType(gs2)
GSEABase::GeneSetCollection(gs1, gs2) |> msigdb::getMsigIdType()
GSEABase::GeneSetCollection(gs1) |> msigdb::getMsigIdType()
GSEABase::GeneSetCollection(gs1) |> msigdb::getMsigIdType() |> is("SymbolIdentifier")
GSEABase::GeneSetCollection(gs1, gs2)
GSEABase::GeneSetCollection(gs1, gs2) |> GSEABase::GeneSetCollection(gs1)
GSEABase::GeneSetCollection(gs1, gs2) |> GSEABase::GeneSetCollection(NK_markers$HGNC_Symbol[1:10])
GSEABase::GeneSetCollection(gs1, gs2, gs1)
GSEABase::GeneSetCollection(gs1, gs2, NK_markers$HGNC_Symbol[1:10])
GSEABase::GeneSetCollection(gs1)
GSEABase::GeneSetCollection(gs1) |> GSEABase::GeneSetCollection(gs2)
GSEABase::GeneSetCollection(gs1) |> GSEABase::GeneSetCollection(gs2)
GSEABase::GeneSetCollection(gs1) | GSEABase::GeneSetCollection(gs2)
c(GSEABase::GeneSetCollection(gs1), GSEABase::GeneSetCollection(gs2))
c(GSEABase::GeneSetCollection(gs1), GSEABase::GeneSetCollection(gs2)) |> GSEABase::GeneSetCollection()
GSEABase::GeneSetCollection(gs1,gs2)
GSEABase::GeneSetCollection(gs1,gs2)[1]
GSEABase::GeneSetCollection(gs1,gs2)[1:2]
GSEABase::GeneSetCollection(gs1,gs2)[1:2 < 1]
GSEABase::GeneSetCollection(gs1,gs2)[1:2 < 2]
c(GSEABase::GeneSetCollection(gs1), GSEABase::GeneSetCollection(gs2))
list(GSEABase::GeneSetCollection(gs1), GSEABase::GeneSetCollection(gs2))
list(GSEABase::GeneSetCollection(gs1), GSEABase::GeneSetCollection(gs2)) |> GSEABase::GeneSetCollection()
c(GSEABase::GeneSetCollection(gs1), GSEABase::GeneSetCollection(gs2)) |> GSEABase::GeneSetCollection()
GSEABase::GeneSetCollection(gs1,gs2)
GSEABase::GeneSetCollection(list(gs1,gs2))
GSEABase::GeneSetCollection(c(gs1,gs2))
c(gs1,gs2)
list(gs1,gs2)
GSEABase::GeneSetCollection(list(gs1,gs2))
get_lm_sig <- function(lm7.pattern, lm22.pattern, ...){
if(!exists(lm7.pattern) & !exists(lm22.pattern))
stop("Must provide at least one of lm7.pattern and lm22.pattern param!")
if(exists(lm7.pattern)){
markers_7 <- subset(LM7, grepl(lm7.pattern, Subset, ...))$Gene
markers <- markers_7
}
if(exists(lm22.pattern)){
idx <- grep(lm22.pattern, colnames(LM22)[-1], ...)
idx <- Reduce(function(x,y){x == 1 | y == 1}, LM22[,-1][,idx]) |>
as.logical()
markers_22 <- LM22$Gene[idx]
markers <- markers_22
}
if(exists(lm7.pattern) & exists(lm22.pattern)){
markers <- union(markers_7, markers_22)
}
return(markers)
}
get_lm_sig()
exists(lm)
exists(gs1)
exists("gs1")
exists("lm")
lm
exists("lm7")
get_lm_sig <- function(lm7.pattern, lm22.pattern, ...){
if(!exists("lm7.pattern") & !exists("lm22.pattern"))
stop("Must provide at least one of lm7.pattern and lm22.pattern param!")
if(exists("lm7.pattern")){
markers_7 <- subset(LM7, grepl(lm7.pattern, Subset, ...))$Gene
markers <- markers_7
}
if(exists("lm22.pattern")){
idx <- grep(lm22.pattern, colnames(LM22)[-1], ...)
idx <- Reduce(function(x,y){x == 1 | y == 1}, LM22[,-1][,idx]) |>
as.logical()
markers_22 <- LM22$Gene[idx]
markers <- markers_22
}
if(exists("lm7.pattern") & exists("lm22.pattern")){
markers <- union(markers_7, markers_22)
}
return(markers)
}
get_lm_sig()
exists("lm7.pattern")
get_lm_sig()
get_lm_sig("NK")
get_lm_sig <- function(lm7.pattern, lm22.pattern, ...){
if(missing("lm7.pattern") & missing("lm22.pattern"))
stop("Must provide at least one of lm7.pattern and lm22.pattern param!")
if(!missing("lm7.pattern")){
markers_7 <- subset(LM7, grepl(lm7.pattern, Subset, ...))$Gene
markers <- markers_7
}
if(!missing("lm22.pattern")){
idx <- grep(lm22.pattern, colnames(LM22)[-1], ...)
idx <- Reduce(function(x,y){x == 1 | y == 1}, LM22[,-1][,idx]) |>
as.logical()
markers_22 <- LM22$Gene[idx]
markers <- markers_22
}
if(!missing("lm7.pattern") & !missing("lm22.pattern")){
markers <- union(markers_7, markers_22)
}
return(markers)
}
get_lm_sig()
get_lm_sig("NK")
get_lm_sig(lm22.pattern = "NK")
get_lm_sig(lm22.pattern = "NK", "NK")
rm(get_lm_sig)
gs1
GSEABase::geneIdType(gs1)
GSEABase::geneIdType(gs2)
GSEABase::GeneSet(GSEABase::geneIds(gs1), setName = "LM7",
geneIdType = SymbolIdentifier())
GSEABase::GeneSet(GSEABase::geneIds(gs1), setName = "LM7",
geneIdType = GSEABase::SymbolIdentifier())
load_all()
get_lm_sig()
get_lm_sig("NK")
get_lm_sig("NK","NK")
get_lm_sig(lm22.pattern = "NK")
get_lm_sig("NK","NK") |> length()
get_lm_sig("NK","NK") |> GSEABase::geneIds()
get_lm_sig("NK") |> GSEABase::geneIds()
use_package("GSEABase")
gs1
gs1@geneIds
get_lm_sig("NK","NK:)
get_lm_sig("NK","NK")
GSEABase::GeneSetCollection(gs1,gs2)
identical(get_lm_sig("NK","NK"), GSEABase::GeneSetCollection(gs1,gs2))
get_lm_sig("NK","NK") == GSEABase::GeneSetCollection(gs1,gs2)
GSEABase::geneIdType(gs2)
GSEABase::geneIdType(gs2) <- GSEABase::SymbolIdentifier()
identical(get_lm_sig("NK","NK"), GSEABase::GeneSetCollection(gs1,gs2))
get_lm_sig("NK","NK") == GSEABase::GeneSetCollection(gs1,gs2)
GSEABase::GeneSetCollection(gs1,gs2)
get_lm_sig("NK","NK")
get_lm_sig("NK","NK")->gsc
gsc
GSEABase::geneIds(gsc)
GSEABase::geneIds(gsc) |> union()
GSEABase::geneIds(gsc) |> Reduce(|)
GSEABase::geneIds(gsc) |> Reduce(`|`)
GSEABase::geneIds(gsc) |> Reduce(union)
GSEABase::geneIds(gsc) |> Reduce(f = |)
GSEABase::geneIds(gsc) |> Reduce(f = `|`)
GSEABase::geneIds(gsc) |> Reduce(f = union)
gs1 | gs2
(gs1 | gs2)@geneIds
gs1 == gs2
identical(gs1, gs2)
identical(gs1, gs1)
identical(gsc, gsc)
identical(gsc, get_lm_sig("NK","NK"))
gs1 <- get_lm_sig("NK")
gs2 <- get_lm_sig(lm22.pattern = "NK")
gs2
gsc <- GSEABase::GeneSetCollection(gs1,gs2)
gsc
identical(gsc, get_lm_sig("NK","NK"))
get_lm_sig("NK","NK")
identical(gsc, get_lm_sig("NK","NK"))
gsc <- GSEABase::GeneSetCollection(list(gs1,gs2))
identical(gsc, get_lm_sig("NK","NK"))
GSEABase::geneIds(gsc)
GSEABase::geneIds(gsc) == (gs1 | gs2)@geneIds
identical(GSEABase::geneIds(gsc), (gs1 | gs2)@geneIds)
(gs1 | gs2)@geneIds
GSEABase::geneIds(gsc) == list(gs1@geneIds, gs2@geneIds)
identical(GSEABase::geneIds(gsc), list(gs1@geneIds, gs2@geneIds))
GSEABase::geneIds(gsc)
GSEABase::geneIds(gsc) |> union()
GSEABase::geneIds(gsc) |> Reduce(f = union)
typeof(gs1)
expect_s4_class(gs1,"GeneSet")
expect_is(gs1, "GeneSet")
expect_s4_class(gs1,"GeneSet")
expect_s4_class(gs1,"test")
expect_s4_class(gs1,"chr")
expect_s4_class(gs1,"GeneSet")
expect_s4_class(gsc,"GeneSet")
expect_s4_class(gsc,"GeneSetCollection")
msigdbr::msigdbr(species = "Homo sapiens", category = "C5",
subcategory = "GO:BP")
msigdbr::msigdbr(species = "Homo sapiens", category = "C5",
subcategory = "GO:BP") |> system.time()
getMsigdb(org = 'hs', id = 'SYM', version = '7.4') |> system.time()
msigdb::getMsigdb(org = 'hs', id = 'SYM', version = '7.4') |> system.time()
msigdb::getMsigdb(org = 'hs', id = 'SYM', version = '7.4')
msigdbr::msigdbr(species = "Homo sapiens") |> system.time()
msigdb::getMsigdb(org = 'hs', id = 'SYM') |> system.time()
msigdb::getMsigdb(org = 'hs', id = 'SYM', version = '7.4') |> system.time()
load_all()
get_msigdb_sig(pattern = "NK")
get_msigdb_sig(pattern = "NK") |> system.time()
get_msigdb_sig(pattern = "NK") |> is("GeneSet")
use_r("list_panglao_organs")
load_all()
list_panglao_organs()
load_all()
list_panglao_types()
list_panglao_types("test")
list_panglao_types("Immune system")
use_test("list_panglao_organs")
list_panglao_organs()
list_panglao_organs() |> is.character()
use_test("list_panglao_types")
list_panglao_types(organ = "unknow")
load_all()
load_all()
get_panglao_sig("NK cells")
get_panglao_sig("NK cell")
typeof(gs1)
GSEABase::geneIds(gsc)
GSEABase::geneIds(gsc) |> names()
is(markers_list, "GeneSetCollection")
is(gsc, "GeneSetCollection")
names(gsc)
names(gs1)
is.list(gsc)
is.list(gs1)
c(gs1,gs2)
list(gs1,gs2)
list(gs1,gs2) |> names()
list(gs1,gs2) |> typeof()
list(gs1,gs2) |> class
list(gs1,gs2) |> class()
lapply((list(gs1,gs2), \(x) is(x, "GeneSet"))
lapply(list(gs1,gs2), \(x) is(x, "GeneSet"))
sapply(list(gs1,gs2), \(x) is(x, "GeneSet"))
list(gs1,gs2) |> class()
list(gs1,gs2)
list(gs1,gs2) |> GSEABase::geneIds()
list(gs1,gs2) |> GSEABase::GeneSetCollection()
sapply(gsc, function(x) is(x,"GeneSet"))
GSEABase::GeneSetCollection(gsc)
sapply(gsc, function(x) is(x,"GeneSet"))
sapply(gsc, function(x) is(x,"GeneSet")) |> all()
sapply(gsc, function(x) is(x,"GeneSet")) |> any()
any(c(F,F))
any(c(F,T))
GSEABase::GeneSetCollection(gs1. gs2)
GSEABase::GeneSetCollection(gs1, gs2)
GSEABase::GeneSetCollection(gs1, gs2, NK_markers$HGNC_Symbol)
GSEABase::GeneSetCollection(list(NK_markers$HGNC_Symbol |>
GSEABase::GeneSet(setName = "NK_curson",
geneIdType = GSEABase::SymbolIdentifier()),
Msig,
Panglao))
GSEABase::GeneSetCollection(list(NK_markers$HGNC_Symbol |>
GSEABase::GeneSet(setName = "NK_curson",
geneIdType = GSEABase::SymbolIdentifier()),
gs1,
gs2))
GSEABase::GeneSetCollection(list(NK_markers$HGNC_Symbol |>
GSEABase::GeneSet(setName = "NK_curson",
geneIdType = GSEABase::SymbolIdentifier()),
gs1,
gs2)) |> merge_markers()
load_all()
GSEABase::GeneSetCollection(list(NK_markers$HGNC_Symbol |>
GSEABase::GeneSet(setName = "NK_curson",
geneIdType = GSEABase::SymbolIdentifier()),
gs1,
gs2)) |> merge_markers()
GSEABase::GeneSetCollection(list(NK_markers$HGNC_Symbol |>
GSEABase::GeneSet(setName = "NK_curson",
geneIdType = GSEABase::SymbolIdentifier()),
gs1,
gs2)) |> merge_markers() |> tail()
check()
test()
check()
check()
document()
load_all()
?get_lm_sig
?sig_gseaplot
?sig_boxplot
document()
?sig_boxplot
document()
?sig_gseaplot
load_all()
?sig_gseaplot
?sig_heatmap
document()
?sig_heatmap
document()
?sig_heatmap
document()
?sig_rankdensity_plot
?sig_scatter_plot
check()
?get_degs
document()
?get_degs
?get_de_table
document()
?get_de_table
?get_degs
document()
?filter_subset_sig
document()
?filter_subset_sig
document()
?filter_subset_sig
document()
?filter_subset_sig
document()
document()
document()
document()
check()
use_package("enrichplot")
document()
check()
load_all()
load_all()
load_all()
document()
load_all()
load_all()
check()
load_all()
use_import_from("enrichplot", gseaplot2)
rlang::last_error()
use_import_from("enrichplot", "gseaplot2")
document()
load_all()
load_all()
load_all()
document()
load_all()
use_import_from("enrichplot", "gseaplot2")
use_import_from("enrichplot", "gseaplot2",load = FALSE)
use_import_from("enrichplot", "gseaplot2",load = FALSE)
document()
load_all()
load_all()
load_all()
document()
load_all()
load_all()
document()
load_all()
load_all()
load_all()
check()
use_import_from("enrichplot", "gseaplot2",load = FALSE)
check()
load_all()
load_all()
document()
document()
load_all()
load_all()
check()
use_package("enrichplot")
document()
load_all()
load_all()
check()
document()
check()
library(devtools)
library(devtools)
library(devtools)
library(devtools)
